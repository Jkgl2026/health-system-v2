# Supabase æ•°æ®å¯¼å…¥æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—æŒ‡å¯¼ä½ å¦‚ä½•å°† Supabase æ•°æ®åº“ä¸­çš„æ•°æ®å¯¼å‡ºï¼Œå¹¶å¯¼å…¥åˆ° Coze å¹³å°çš„æ•°æ®åº“ä¸­ï¼Œä»è€Œå®ç°æ•°æ®ç»Ÿä¸€ã€‚

## ğŸ¯ ç›®æ ‡

- âœ… ä»¥ååœ¨ Coze å¹³å°å¡«å†™æ•°æ®
- âœ… çœ‹åˆ°ä¹‹å‰åœ¨ Cloudflare Pages å¡«å†™çš„æ‰€æœ‰æ•°æ®ï¼ˆSupabase æ•°æ®åº“ä¸­ï¼‰
- âœ… æ•°æ®ç»Ÿä¸€ç®¡ç†

---

## ğŸ“¤ æ­¥éª¤1ï¼šä» Supabase å¯¼å‡ºæ•°æ®

### 1.1 ç™»å½• Supabase Dashboard

1. è®¿é—® https://supabase.com/dashboard
2. ä½¿ç”¨ä½ çš„è´¦å·ç™»å½•
3. é€‰æ‹©ä½ çš„é¡¹ç›®ï¼ˆ`health-system-v2`ï¼‰

### 1.2 å¯¼å‡ºæ•°æ®

**æ–¹æ³•1ï¼šä½¿ç”¨ SQL Editorï¼ˆæ¨èï¼‰**

1. ç‚¹å‡»å·¦ä¾§èœå•çš„ "SQL Editor"
2. ç‚¹å‡» "New query"
3. å¤åˆ¶å¹¶è¿è¡Œä»¥ä¸‹ SQL è¯­å¥ï¼š

```sql
-- å¯¼å‡ºæ‰€æœ‰è¡¨çš„æ•°æ®
SELECT json_build_object(
  'users', (SELECT json_agg(users) FROM users),
  'admins', (SELECT json_agg(admins) FROM admins),
  'symptom_checks', (SELECT json_agg(symptom_checks) FROM symptom_checks),
  'health_analysis', (SELECT json_agg(health_analysis) FROM health_analysis),
  'user_choices', (SELECT json_agg(user_choices) FROM user_choices),
  'requirements', (SELECT json_agg(requirements) FROM requirements),
  'courses', (SELECT json_agg(courses) FROM courses)
) AS data;
```

4. å¤åˆ¶æŸ¥è¯¢ç»“æœï¼ˆJSON æ•°æ®ï¼‰
5. ä¿å­˜ä¸ºæ–‡ä»¶ `supabase-export.json`

**æ–¹æ³•2ï¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¦‚æœä½ æœ‰ psql å®¢æˆ·ç«¯ï¼‰**

```bash
psql "postgresql://postgres:rTrWXqwle5phUGY4@db.rtccwmuryojxgxyuktjk.supabase.co:5432/postgres" \
  -c "COPY (SELECT json_agg(users) FROM users) TO STDOUT WITH (FORMAT json);"
```

---

## ğŸ“¥ æ­¥éª¤2ï¼šå‡†å¤‡å¯¼å…¥æ•°æ®

### 2.1 è½¬æ¢æ•°æ®æ ¼å¼

å°†å¯¼å‡ºçš„ JSON æ•°æ®è½¬æ¢ä¸ºä»¥ä¸‹æ ¼å¼ï¼š

```json
{
  "success": true,
  "message": "æ•°æ®å¯¼å‡ºæˆåŠŸ",
  "data": {
    "timestamp": "2026-02-03T14:04:04.825Z",
    "statistics": {
      "users": 59,
      "admins": 1,
      "symptom_checks": 0,
      "health_analysis": 0,
      "user_choices": 0,
      "requirements": 0,
      "courses": 72
    },
    "totalUsers": 59,
    "data": {
      "users": [...],
      "admins": [...],
      "symptom_checks": [...],
      "health_analysis": [...],
      "user_choices": [...],
      "requirements": [...],
      "courses": [...]
    }
  }
}
```

### 2.2 ä¸Šä¼ æ•°æ®æ–‡ä»¶

å°†å‡†å¤‡å¥½çš„ JSON æ–‡ä»¶ä¸Šä¼ åˆ° Coze å¹³å°é¡¹ç›®çš„ `assets/` ç›®å½•ï¼Œå‘½åä¸º `supabase-import.json`ã€‚

---

## ğŸ”§ æ­¥éª¤3ï¼šæ‰§è¡Œå¯¼å…¥

### 3.1 ä½¿ç”¨å¯¼å…¥è„šæœ¬

1. è¿›å…¥ Coze å¹³å°é¡¹ç›®çš„æ ¹ç›®å½•
2. è¿è¡Œå¯¼å…¥è„šæœ¬ï¼š

```bash
node scripts/import-supabase-data.js assets/supabase-import.json
```

### 3.2 æŸ¥çœ‹å¯¼å…¥ç»“æœ

å¯¼å…¥å®Œæˆåï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹è¾“å‡ºï¼š

```
ğŸš€ å¼€å§‹å¯¼å…¥æ•°æ®...

ğŸ“– è¯»å–æ•°æ®æ–‡ä»¶: assets/supabase-import.json
âœ… æ•°æ®æ–‡ä»¶è§£ææˆåŠŸ
ğŸ“Š æ•°æ®ç»Ÿè®¡: {"users":59,"admins":1,"symptom_checks":0,"health_analysis":0,"user_choices":0,"requirements":0,"courses":72}
ğŸ“… å¯¼å‡ºæ—¶é—´: 2026-02-03T14:04:04.825Z

ğŸ‘¤ å¼€å§‹å¯¼å…¥ç”¨æˆ·æ•°æ® (59 æ¡)...
  âœ… ç”¨æˆ·æ•°æ®å¯¼å…¥å®Œæˆ (59 æ¡æˆåŠŸ)
ğŸ‘‘ å¼€å§‹å¯¼å…¥ç®¡ç†å‘˜æ•°æ® (1 æ¡)...
  âœ… ç®¡ç†å‘˜æ•°æ®å¯¼å…¥å®Œæˆ (1 æ¡æˆåŠŸ)
ğŸ“š å¼€å§‹å¯¼å…¥è¯¾ç¨‹æ•°æ® (72 æ¡)...
  âœ… è¯¾ç¨‹æ•°æ®å¯¼å…¥å®Œæˆ (72 æ¡æˆåŠŸ)

ğŸ‰ æ•°æ®å¯¼å…¥å®Œæˆ! æ€»å…±å¯¼å…¥äº† 132 æ¡è®°å½•
```

---

## âœ… æ­¥éª¤4ï¼šéªŒè¯å¯¼å…¥ç»“æœ

### 4.1 è®¿é—® Coze å¹³å°åå°

1. æ‰“å¼€ Coze å¹³å°çš„åå°ç®¡ç†é¡µé¢
2. æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
3. ç¡®è®¤æ˜¯å¦èƒ½çœ‹åˆ° Supabase æ•°æ®åº“ä¸­çš„ç”¨æˆ·

### 4.2 æµ‹è¯•æ•°æ®å¡«å†™

1. åœ¨ Coze å¹³å°å¡«å†™æ–°çš„å¥åº·è‡ªæ£€æ•°æ®
2. æäº¤åæŸ¥çœ‹åå°
3. ç¡®è®¤æ•°æ®æ˜¯å¦æ­£ç¡®ä¿å­˜

---

## ğŸ”„ æ•°æ®åˆå¹¶è¯´æ˜

### å½“å‰æƒ…å†µ

- **Coze å¹³å°æ•°æ®åº“**ï¼šå·²æœ‰ 59 ä¸ªç”¨æˆ·
- **Supabase æ•°æ®åº“**ï¼šå¯èƒ½æœ‰ç”¨æˆ·æ•°æ®ï¼ˆéœ€è¦å¯¼å‡ºæŸ¥çœ‹ï¼‰

### å¯¼å…¥ç­–ç•¥

å¯¼å…¥è„šæœ¬ä½¿ç”¨ `onConflictDoNothing()` ç­–ç•¥ï¼Œè¿™æ„å‘³ç€ï¼š
- å¦‚æœæ•°æ®å·²å­˜åœ¨ï¼ˆåŸºäºä¸»é”® IDï¼‰ï¼Œåˆ™è·³è¿‡
- å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥æ–°æ•°æ®
- ä¸ä¼šè¦†ç›–æˆ–åˆ é™¤ç°æœ‰æ•°æ®

### é¢„æœŸç»“æœ

å¯¼å…¥å®Œæˆåï¼ŒCoze å¹³å°æ•°æ®åº“å°†åŒ…å«ï¼š
- âœ… Coze å¹³å°åŸæœ‰çš„ç”¨æˆ·æ•°æ®
- âœ… Supabase æ•°æ®åº“ä¸­çš„ç”¨æˆ·æ•°æ®
- âœ… æ‰€æœ‰ç”¨æˆ·è‡ªæ£€æ•°æ®
- âœ… æ‰€æœ‰å¥åº·åˆ†ææ•°æ®

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœåœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼š

1. Supabase Dashboard çš„ç‰ˆæœ¬å’Œç•Œé¢
2. å¯¼å‡ºæ—¶é‡åˆ°çš„é”™è¯¯ä¿¡æ¯
3. å¯¼å…¥æ—¶é‡åˆ°çš„é”™è¯¯ä¿¡æ¯

æˆ‘å°†æ ¹æ®ä½ çš„å…·ä½“æƒ…å†µæä¾›è¿›ä¸€æ­¥çš„æŒ‡å¯¼ï¼

---

## ğŸ¯ å®Œæˆåçš„æ•ˆæœ

å¯¼å…¥å®Œæˆåï¼š
- âœ… åœ¨ Coze å¹³å°çœ‹åˆ°æ‰€æœ‰å†å²æ•°æ®
- âœ… åœ¨ Coze å¹³å°å¡«å†™æ–°æ•°æ®
- âœ… æ•°æ®ç»Ÿä¸€ç®¡ç†
- âœ… ä»¥åä¸å†ä½¿ç”¨ Cloudflare Pages

---

**å‡†å¤‡å¥½å¼€å§‹æ“ä½œäº†å—ï¼Ÿæœ‰ä»»ä½•é—®é¢˜éšæ—¶é—®æˆ‘ï¼** ğŸš€
