# ğŸš€ å¥åº·è‡ªæ£€ç³»ç»Ÿ - å®Œæ•´éƒ¨ç½²æŒ‡å—

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ src/                      # Web ç‰ˆï¼ˆNext.jsï¼‰
â”‚   â”œâ”€â”€ app/                  # é¡µé¢å’Œè·¯ç”±
â”‚   â”œâ”€â”€ components/           # UI ç»„ä»¶
â”‚   â””â”€â”€ lib/                  # å·¥å…·åº“
â”œâ”€â”€ miniprogram/              # å°ç¨‹åºç‰ˆï¼ˆTaroï¼‰
â”‚   â””â”€â”€ health-miniprogram/   # å°ç¨‹åºæºç 
â”‚       â”œâ”€â”€ src/              # é¡µé¢å’Œç»„ä»¶
â”‚       â””â”€â”€ dist/             # æ„å»ºè¾“å‡º
â””â”€â”€ out/                      # Web ç‰ˆé™æ€å¯¼å‡º
```

---

## ğŸŒ ç¬¬ä¸€éƒ¨åˆ†ï¼šWeb ç‰ˆéƒ¨ç½²åˆ° Cloudflare Pages

### æ­¥éª¤ 1ï¼šåˆ›å»º Cloudflare è´¦å·ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰

1. è®¿é—® [Cloudflare.com](https://dash.cloudflare.com/sign-up)
2. æ³¨å†Œè´¦å·ï¼ˆæ”¯æŒé‚®ç®±ã€Googleã€GitHub ç™»å½•ï¼‰
3. Cloudflare Pages æ°¸ä¹…å…è´¹ï¼Œæ— éœ€ç»‘å®šä¿¡ç”¨å¡

### æ­¥éª¤ 2ï¼šè¿æ¥ GitHub ä»“åº“

1. ç™»å½• Cloudflare Dashboard
2. é€‰æ‹© **Pages** â†’ **Create a project**
3. ç‚¹å‡» **Connect to Git**
4. æˆæƒ Cloudflare è®¿é—®ä½ çš„ GitHub
5. é€‰æ‹© `Jkgl2026/health-system-v2` ä»“åº“

### æ­¥éª¤ 3ï¼šé…ç½®æ„å»ºè®¾ç½®

åœ¨ **Build settings** ä¸­å¡«å†™ï¼š

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **Framework preset** | Next.js (Static HTML Export) |
| **Build command** | `npx next build` |
| **Build output directory** | `out` |

### æ­¥éª¤ 4ï¼šç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

ç”±äºæ˜¯é™æ€å¯¼å‡ºï¼Œä¸éœ€è¦ç¯å¢ƒå˜é‡ã€‚ä¹‹å‰çš„ `DATABASE_URL` ç­‰å¯ä»¥åˆ é™¤ã€‚

### æ­¥éª¤ 5ï¼šéƒ¨ç½²

1. ç‚¹å‡» **Save and Deploy**
2. ç­‰å¾… 1-2 åˆ†é’Ÿæ„å»ºå®Œæˆ
3. éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª URLï¼ˆå¦‚ `https://health-system-v2.pages.dev`ï¼‰

### æ­¥éª¤ 6ï¼šé…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰

1. åœ¨ Pages é¡¹ç›®ä¸­ï¼Œè¿›å…¥ **Custom domains**
2. æ·»åŠ ä½ çš„åŸŸåï¼ˆå¦‚ `health.example.com`ï¼‰
3. æ ¹æ®æç¤ºåœ¨ Cloudflare DNS ä¸­æ·»åŠ è®°å½•

---

## ğŸ“± ç¬¬äºŒéƒ¨åˆ†ï¼šå°ç¨‹åºç‰ˆéƒ¨ç½²åˆ°å¾®ä¿¡

### æ­¥éª¤ 1ï¼šæ³¨å†Œå°ç¨‹åº

1. è®¿é—® [å¾®ä¿¡å…¬ä¼—å¹³å°](https://mp.weixin.qq.com/)
2. æ³¨å†Œè´¦å·ï¼ˆ**ä¸ªäººè´¦å·å…è´¹**ï¼Œä¼ä¸šè´¦å· Â¥300/å¹´ï¼‰
3. è·å– AppID

**è´¹ç”¨å¯¹æ¯”ï¼š**
- **ä¸ªäººå°ç¨‹åº**ï¼šÂ¥0 å…è´¹ï¼ˆæ¨èèµ·æ­¥ï¼‰
- **ä¼ä¸šå°ç¨‹åº**ï¼šÂ¥300/å¹´ï¼ˆéœ€è¦è¥ä¸šæ‰§ç…§ï¼‰

### æ­¥éª¤ 2ï¼šå®‰è£…å¼€å‘å·¥å…·

1. ä¸‹è½½ [å¾®ä¿¡å¼€å‘è€…å·¥å…·](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
2. å®‰è£…å¹¶ç™»å½•

### æ­¥éª¤ 3ï¼šæ‰“å¼€é¡¹ç›®

1. å¯åŠ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. ç‚¹å‡» **å¯¼å…¥é¡¹ç›®**
3. é€‰æ‹©ç›®å½•ï¼š`miniprogram/health-miniprogram/dist`
4. å¡«å†™ AppIDï¼ˆæµ‹è¯•ç”¨å¯ä½¿ç”¨æµ‹è¯•å·ï¼‰
5. ç‚¹å‡» **å¯¼å…¥**

### æ­¥éª¤ 4ï¼šé…ç½® AppID

ä¿®æ”¹ `miniprogram/health-miniprogram/project.config.json`ï¼š

```json
{
  "appid": "your-appid-here",  // æ›¿æ¢ä¸ºä½ çš„ AppID
  "projectname": "health-miniprogram"
}
```

### æ­¥éª¤ 5ï¼šé‡æ–°æ„å»ºï¼ˆå¯é€‰ï¼‰

å¦‚æœä¿®æ”¹äº†ä»£ç ï¼Œéœ€è¦é‡æ–°æ„å»ºï¼š

```bash
cd miniprogram/health-miniprogram
pnpm run build:weapp
```

ç„¶ååœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ç‚¹å‡» **ç¼–è¯‘**ã€‚

### æ­¥éª¤ 6ï¼šæµ‹è¯•åŠŸèƒ½

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š

- âœ… é¦–é¡µå¯¼èˆª
- âœ… ç—‡çŠ¶è‡ªæ£€ï¼ˆå¤šé€‰ï¼‰
- âœ… å¥åº·è¯„åˆ†è®¡ç®—
- âœ… å¥åº·å»ºè®®å±•ç¤º
- âœ… å†å²è®°å½•æŸ¥çœ‹
- âœ… å¾®ä¿¡ç™»å½•

### æ­¥éª¤ 7ï¼šä¸Šä¼ ä»£ç 

1. ç‚¹å‡»å·¥å…·æ çš„ **ä¸Šä¼ **
2. å¡«å†™ç‰ˆæœ¬å·ï¼ˆå¦‚ `1.0.0`ï¼‰
3. å¡«å†™å¤‡æ³¨ï¼ˆå¦‚ "é¦–æ¬¡å‘å¸ƒ"ï¼‰
4. ç‚¹å‡» **ä¸Šä¼ **

### æ­¥éª¤ 8ï¼šæäº¤å®¡æ ¸

1. ç™»å½• [å¾®ä¿¡å…¬ä¼—å¹³å°](https://mp.weixin.qq.com/)
2. è¿›å…¥ **ç‰ˆæœ¬ç®¡ç†** â†’ **å¼€å‘ç‰ˆæœ¬**
3. é€‰æ‹©åˆšæ‰ä¸Šä¼ çš„ç‰ˆæœ¬ï¼Œç‚¹å‡» **æäº¤å®¡æ ¸**
4. å¡«å†™å®¡æ ¸ä¿¡æ¯ï¼š
   - å°ç¨‹åºæœåŠ¡ç±»ç›®ï¼š`åŒ»ç–— > åŒ»ç–—ä¿¡æ¯æœåŠ¡` æˆ– `ç”Ÿæ´»æœåŠ¡ > ç”Ÿæ´»æœåŠ¡`
   - åŠŸèƒ½é¡µé¢ï¼šé¦–é¡µ `/pages/index/index`
5. ç­‰å¾…å®¡æ ¸ï¼ˆ1-7ä¸ªå·¥ä½œæ—¥ï¼‰

### æ­¥éª¤ 9ï¼šå‘å¸ƒä¸Šçº¿

å®¡æ ¸é€šè¿‡åï¼Œç‚¹å‡» **å‘å¸ƒ**ï¼Œå°ç¨‹åºå³å¯ä¸Šçº¿ä½¿ç”¨ã€‚

---

## â˜ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šé…ç½®äº‘æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰

### æ­¥éª¤ 1ï¼šå¼€é€šäº‘å¼€å‘

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼Œç‚¹å‡» **äº‘å¼€å‘**
2. åˆ›å»ºç¯å¢ƒï¼ˆå…è´¹ç‰ˆï¼‰
3. ç¯å¢ƒåç§°ï¼š`health-system`

### æ­¥éª¤ 2ï¼šåˆå§‹åŒ–äº‘å¼€å‘

ä¿®æ”¹ `miniprogram/health-miniprogram/src/utils/cloud.ts`ï¼š

```typescript
import Taro from '@tarojs/taro'

// åˆå§‹åŒ–äº‘å¼€å‘
Taro.cloud.init({
  env: 'health-system-xxxxx',  // æ›¿æ¢ä¸ºä½ çš„ç¯å¢ƒID
  traceUser: true
})

const db = Taro.cloud.database()

export { db }
```

### æ­¥éª¤ 3ï¼šåˆ›å»ºæ•°æ®åº“é›†åˆ

åœ¨äº‘å¼€å‘æ§åˆ¶å°åˆ›å»ºä»¥ä¸‹é›†åˆï¼š

| é›†åˆå | ç”¨é€” |
|--------|------|
| `users` | ç”¨æˆ·ä¿¡æ¯ |
| `symptom_checks` | ç—‡çŠ¶æ£€æŸ¥è®°å½• |
| `health_analysis` | å¥åº·åˆ†æè®°å½• |

### æ­¥éª¤ 4ï¼šä¿®æ”¹æ•°æ®å±‚

åœ¨ `src/utils/cloud.ts` ä¸­ï¼Œå°†æœ¬åœ°å­˜å‚¨æ›¿æ¢ä¸ºäº‘æ•°æ®åº“è°ƒç”¨ï¼š

```typescript
// ç¤ºä¾‹ï¼šä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°äº‘æ•°æ®åº“
async saveUserInfo(userInfo: UserData) {
  try {
    const result = await db.collection('users').add({
      data: {
        ...userInfo,
        createTime: new Date().getTime()
      }
    })
    return { success: true, data: result }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

---

## ğŸ’° è´¹ç”¨æ€»ç»“

### Web ç‰ˆï¼ˆCloudflare Pagesï¼‰

| é¡¹ç›® | æˆæœ¬ |
|------|------|
| éƒ¨ç½² | Â¥0 |
| å­˜å‚¨ | Â¥0 |
| æµé‡ | Â¥0 |
| CDN | Â¥0 |
| **åˆè®¡** | **Â¥0** |

### å°ç¨‹åºç‰ˆï¼ˆä¸ªäººè´¦å·ï¼‰

| ç”¨æˆ·é‡ | æœˆæˆæœ¬ |
|--------|--------|
| 1000 | Â¥0 |
| 10000 | Â¥1.18 |
| 100000 | Â¥32.83 |

**å…è´¹é¢åº¦ï¼š**
- æ•°æ®åº“å­˜å‚¨ï¼š2GB
- CDN æµé‡ï¼š5GB/æœˆ
- äº‘å‡½æ•°è°ƒç”¨ï¼š42ä¸‡æ¬¡/æœˆ

### æ€»è®¡ï¼ˆåŒç‰ˆæœ¬ï¼‰

| ç”¨æˆ·é‡ | æœˆæˆæœ¬ | å¹´æˆæœ¬ |
|--------|--------|--------|
| 1000 | **Â¥0** | **Â¥0** |
| 10000 | **Â¥1.18** | **Â¥14.16** |
| 100000 | **Â¥32.83** | **Â¥393.96** |

---

## ğŸ¯ åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | Web ç‰ˆ | å°ç¨‹åºç‰ˆ |
|------|--------|---------|
| ç—‡çŠ¶è‡ªæ£€ | âœ… | âœ… |
| å¥åº·è¯„åˆ† | âœ… | âœ… |
| å†å²è®°å½• | âœ… | âœ… |
| å¥åº·åˆ†æ | âœ… | âœ… |
| PWA æ¡Œé¢å®‰è£… | âœ… | âŒ |
| å¾®ä¿¡ç™»å½• | âŒ | âœ… |
| å¾®ä¿¡åˆ†äº« | âŒ | âœ… |
| å¾®ä¿¡æ”¯ä»˜ | âŒ | âŒï¼ˆéœ€è¦ä¼ä¸šè´¦å·ï¼‰ |
| è·¨è®¾å¤‡åŒæ­¥ | âŒ | âœ…ï¼ˆäº‘æ•°æ®åº“ï¼‰ |
| å›½å†…è®¿é—® | âœ… | âœ… |

---

## ğŸ“ å¼€å‘å‘½ä»¤

### Web ç‰ˆ

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¼€å‘æ¨¡å¼
pnpm run dev

# æ„å»ºé™æ€å¯¼å‡º
npx next build

# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
pnpm run start
```

### å°ç¨‹åºç‰ˆ

```bash
# å®‰è£…ä¾èµ–
cd miniprogram/health-miniprogram
pnpm install

# å¼€å‘æ¨¡å¼
pnpm run dev:weapp

# æ„å»º
pnpm run build:weapp

# H5 ç‰ˆæœ¬
pnpm run dev:h5
pnpm run build:h5
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: Web ç‰ˆå¦‚ä½•ä¿®æ”¹é¦–é¡µå†…å®¹ï¼Ÿ
A: ç¼–è¾‘ `src/app/page.tsx`ï¼Œç„¶åé‡æ–°æ„å»ºï¼š
```bash
npx next build
```

### Q2: å°ç¨‹åºç‰ˆå¦‚ä½•æ·»åŠ æ–°ç—‡çŠ¶ï¼Ÿ
A: åœ¨ `miniprogram/health-miniprogram/src/pages/check/index.tsx` ä¸­æ·»åŠ ï¼š

```typescript
symptoms: [
  // ... ç°æœ‰ç—‡çŠ¶
  { id: '13', name: 'æ–°ç—‡çŠ¶', category: 'åˆ†ç±»' }
]
```

### Q3: å¦‚ä½•ä¿®æ”¹å¥åº·è¯„åˆ†ç®—æ³•ï¼Ÿ
A: Web ç‰ˆï¼š`src/pages/result/page.tsx`
å°ç¨‹åºç‰ˆï¼š`miniprogram/health-miniprogram/src/pages/result/index.tsx`

### Q4: å°ç¨‹åºå®¡æ ¸è¢«æ‹’æ€ä¹ˆåŠï¼Ÿ
A: å¸¸è§åŸå› ï¼š
- éœ€è¦åŒ»ç–—ç›¸å…³èµ„è´¨
- å°ç¨‹åºåŠŸèƒ½ä¸å®Œæ•´
- ç¼ºå°‘éšç§æ”¿ç­–

è§£å†³æ–¹æ¡ˆï¼š
- é€‰æ‹©"ç”Ÿæ´»æœåŠ¡"ç±»ç›®
- å®Œå–„æ‰€æœ‰åŠŸèƒ½é¡µé¢
- æ·»åŠ éšç§å£°æ˜

### Q5: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
A: å°ç¨‹åºç‰ˆæ”¯æŒæ•°æ®å¯¼å‡ºï¼š
```typescript
// åœ¨"æˆ‘çš„"é¡µé¢æ·»åŠ å¯¼å‡ºåŠŸèƒ½
const { data } = await miniDataManager.exportData()
console.log(data)  // JSON æ ¼å¼çš„æ•°æ®
```

---

## ğŸ“š æ›´å¤šæ–‡æ¡£

- [Cloudflare Pages å®˜æ–¹æ–‡æ¡£](https://developers.cloudflare.com/pages/)
- [å¾®ä¿¡å°ç¨‹åºå¼€å‘æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [Taro æ¡†æ¶æ–‡æ¡£](https://taro.zone/)
- [Next.js æ–‡æ¡£](https://nextjs.org/)

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„å¥åº·è‡ªæ£€ç³»ç»Ÿï¼š
1. **Web ç‰ˆ**ï¼šéƒ¨ç½²åœ¨ Cloudflare Pagesï¼ˆæ°¸ä¹…å…è´¹ï¼‰
2. **å°ç¨‹åºç‰ˆ**ï¼šéƒ¨ç½²åœ¨å¾®ä¿¡å°ç¨‹åºï¼ˆ1000ç”¨æˆ·å†…å…è´¹ï¼‰

é€‰æ‹©é€‚åˆä½ çš„ç‰ˆæœ¬å¼€å§‹ä½¿ç”¨ï¼
